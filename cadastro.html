<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro - Plataforma Poisson</title>
    <link rel="stylesheet" href="style/global.css">
    <link rel="stylesheet" href="style/navbar.css">
    <link rel="stylesheet" href="style/footer.css">
    <link rel="stylesheet" href="style/cadastro.css">
</head>

<body>
    <header id="cabecalho"></header>
   <main class="cadastro">
    <div class="cadastro__container">
        <h1 class="cadastro__titulo">Cadastro</h1>
        <p class="cadastro__subtitulo">Crie sua conta para acessar a plataforma</p>

        <form id="registerForm">

            <input id="username" class="cadastro__campo" type="text" placeholder="Nome completo" required>

            <input id="dateOfBirth" class="cadastro__campo" type="date" placeholder="Data de nascimento" required>

            <input id="email" class="cadastro__campo" type="email" placeholder="Email" required>

            <input id="password" class="cadastro__campo" type="password" placeholder="Senha" required>

            <input id="confirmPassword" class="cadastro__campo" type="password" placeholder="Confirmar senha" required>

            <!-- opcional -->
            <input id="profilePicture" type="hidden" value="">

            <button class="cadastro__botao" type="submit">Cadastrar</button>
        </form>

        <div class="cadastro__alternar">
            Já tem conta? <a class="cadastro__alternar-link" href="login.html">Entrar</a>
        </div>
    </div>
</main>

    <!-- FOOTER -->
    <footer class="rodape" id="rodape"></footer>
    <script src="layout.js"></script>
    <script type="module" src="auth.js"></script>
<script type="module">
    import { registerUser } from "./auth.js";

    document.getElementById("registerForm").addEventListener("submit", async (e) => {
        e.preventDefault(); // impede recarregar a página

        const usuario = {
            profilePicture: "",
            username: document.getElementById("username").value,
            dateOfBirth: document.getElementById("dateOfBirth").value,
            email: document.getElementById("email").value,
            password: document.getElementById("password").value,
            confirmPassword: document.getElementById("confirmPassword").value
        };

        console.log("Enviando cadastro:", usuario);

        try {
            const resultado = await registerUser(usuario);

            console.log("RESPOSTA DO BACKEND:", resultado);

            alert("Cadastro realizado com sucesso!");
            window.location.href = "login.html";

        } catch (error) {
            alert("Erro ao cadastrar: " + error.message);
        }
    });
</script>


</body>

</html>